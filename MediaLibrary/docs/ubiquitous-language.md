# MediaLibrary - ユビキタス言語定義書

## 概要

MediaLibraryContextにおいて、ドメインエキスパートと開発者が共通して使用する用語を定義します。

## 用語定義

### 基本概念

#### Media (メディア)
- **定義**: デバイスのストレージに保存されている写真または動画ファイル
- **種類**: Photo（写真）、Video（動画）
- **特徴**: 固有の識別子、ファイルパス、メタデータを持つ

#### MediaMetadata (メディアメタデータ)
- **定義**: メディアに関連する基本情報
- **含まれる情報**:
  - 撮影日時 (capturedAt)
  - ファイル形式 (format)

#### MediaLibrary (メディアライブラリ)
- **定義**: デバイス内のすべての写真を管理する概念的なコレクション
- **機能**: 一覧表示、権限管理

#### Thumbnail (サムネイル)
- **定義**: メディアの縮小表示用画像
- **目的**: 一覧表示時のパフォーマンス向上
- **管理**: キャッシュ機能を持つ

### 技術的概念

#### MediaRepository (メディアリポジトリ)
- **定義**: メディアデータの取得を抽象化するプロトコル
- **機能**: メディアの取得、サムネイルの取得
- **実装**: MediaRepositoryImpl (struct実装)

#### PhotoLibraryPermissionService (写真ライブラリ権限サービス)
- **定義**: 写真ライブラリへのアクセス権限管理を抽象化するプロトコル
- **機能**: 権限状態確認、権限要求
- **実装**: PhotoLibraryPermissionServiceImpl (struct実装)

#### MediaLibraryAppService (メディアライブラリアプリケーションサービス)
- **定義**: メディアライブラリ関連のユースケースを実装するstruct
- **機能**: メディア一覧取得、サムネイル取得、権限チェック
- **特徴**: プロトコル準拠、DIでの依存関係管理

### 状態・属性

#### MediaType (メディアタイプ)
- **定義**: メディアの種類を表す列挙型
- **値**: photo（写真）

#### MediaFormat (メディアフォーマット)
- **定義**: メディアファイルの形式
- **写真**: JPEG、PNG、HEIC等

#### PhotoLibraryPermission (写真ライブラリ権限)
- **定義**: 写真ライブラリへのアクセス権限の状態
- **値**: 未確認、許可、拒否

## 用語の関係性

```
Media（集約ルート）
├── MediaID
├── MediaType
├── MediaMetadata
│   ├── MediaFormat
│   └── 撮影日時
├── PhotoLibraryPermission
└── Thumbnail
```

## 基本的なビジネスルール（暫定）

> **注意**: 以下のルールは暫定的なものであり、実装時に詳細な挙動を定義していきます。

### メディア管理
- メディアは一意の識別子を持つ
- メディアは撮影日時を基準にソートされる

### サムネイル
- サムネイルは一覧表示時に生成される
- サムネイルはキャッシュされる

## 技術的詳細

### アーキテクチャパターン
- **Composition Root**: AppDependenciesが全体の依存関係を管理
- **Protocol-based DI**: swift-dependenciesの代わりにプロトコルベースのDI
- **structサービス**: ステートレスなサービスはstructで実装

### テストフレームワーク
- **swift-testing**: XCTestの代わりに新しいテストフレームワーク
- **@Test属性**: テストメソッド定義
- **#expect**: アサーションマクロ

### プラットフォーム対応
- **iOS 15+**: iOS専用パッケージ
- **Swift 6**: strict concurrency対応
- **explicit any**: 明示的な型消去

## 関連する他のコンテキスト

### AssetTransferContext
- **関係**: 将来的に、選択されたメディアを転送対象として提供する予定