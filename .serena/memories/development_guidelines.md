# PhotoMove 開発ガイドライン

## ブランチ戦略（トランクベース開発）

### ブランチフロー
1. **Issue作成**: 機能・バグ修正ごとにGitHub Issueを作成
2. **ブランチ作成**: `issue-{issue番号}-{簡潔な説明}` 形式
3. **初回コミット**: 最初のコミット後、直ちにdraft Pull Requestを作成
4. **継続開発**: ブランチで継続的に開発・コミット
5. **レビュー準備**: 実装完了時にPull Requestを「Ready for review」に変更
6. **自動レビュー**: PR オープン時にClaude Codeによる自動レビュー実行
7. **マージ**: レビュー完了後、mainブランチにマージ

### ブランチ命名規則
- `issue-{番号}-{機能名}`: 新機能開発
- `issue-{番号}-fix-{バグ内容}`: バグ修正
- `issue-{番号}-refactor-{対象}`: リファクタリング
- `issue-{番号}-docs-{ドキュメント種類}`: ドキュメント更新

## 開発プロセス基本原則

### イテレーション開発
- **アジャイル開発**: 小さな機能単位でイテレーションを積み上げ
- **Issue単位**: 「写真ライブラリの一覧を取得」「複数選択機能」等の小さい機能を1Issue

### ドキュメント駆動開発フロー
1. **仕様策定**: 機能仕様・概念モデル設計（DDD）・技術的詳細設計
2. **テスト作成（TDD）**: テストファーストでの開発
3. **実装**: 実際のコード実装
4. **動作検証**: 機能の動作確認
5. **レビュー・マージ**: 完成した機能のマージ

### ドキュメント管理原則
- **現在のスコープ**: その機能を実現するスコープに限定して検討
- **最新状態の維持**: DDDドキュメントは常に現在の仕様の最新状態を表現
- **段階的更新**: 機能追加・変更時は該当ドキュメントを更新

## DDD（ドメイン駆動設計）適用

### アーキテクチャ構成
- 境界づけられたコンテキストごとにSwift Packageを分割
- 各コンテキスト内で MVVM + Layered Architecture を採用

### 現在のコンテキスト
1. **MediaLibraryContext**: 写真・動画の管理、閲覧、検索
2. **NetworkConnectionContext**: 通信基盤とデバイス発見
3. **SystemMonitoringContext**: システム状態監視
4. **AssetTransferContext**: アセット転送と転送時役割管理
5. **AppFoundation**: アプリケーション基盤

### レイヤー構成（各パッケージ）
```
[Package]/
├── Presentation/      # SwiftUI Views & ViewModels
├── Application/       # アプリケーションサービス
├── Domain/           # エンティティ、値オブジェクト、集約
├── Infrastructure/   # リポジトリ実装、外部API
└── DependencyInjection/ # DI設定
```

## セキュリティ・プライバシー配慮
- **100%ローカル処理**: 写真データは端末外に送信しない
- **TLS 1.3**: 暗号化通信（ローカルネットワーク内）
- **自己署名証明書**: 適切な管理
- **アプリサンドボックス**: データ保護

## パフォーマンス配慮
- **大量の写真対応**: ページング実装
- **サムネイルキャッシング**: 効率的なメモリ管理
- **Swift Concurrency**: async/await + Actor によるデータ競合防止

## 品質管理基準
- **swift-format**: Apple公式フォーマッター使用
- **swift-testing + XCTest**: 自動テスト
- **UI Testing**: 統合テスト
- **コードレビュー**: Pull Requestベース